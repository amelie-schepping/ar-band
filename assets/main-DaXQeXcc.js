(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function n(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(e){if(e.ep)return;e.ep=!0;const s=n(e);fetch(e.href,s)}})();const y=window.AudioContext||window.webkitAudioContext,r=new y,a="/ar-band/",w={guitar:`${a}assets/audios/guitar.wav`,piano:`${a}assets/audios/piano.wav`,eguitar:`${a}assets/audios/eguitar.wav`,pad:`${a}assets/audios/pad.wav`,melody:`${a}assets/audios/melody.wav`,strings:`${a}assets/audios/strings.wav`},p={},c={},g={},u={guitar:!1,piano:!1,eguitar:!1,pad:!1,melody:!1,strings:!1};let f=null;async function v(t,o){const i=await(await fetch(o)).arrayBuffer(),e=await r.decodeAudioData(i);p[t]=e,g[t]=e.duration}function b(t,o=0){const n=r.createBufferSource();n.buffer=p[t],n.loop=!0,n.connect(r.destination);const i=r.currentTime+o;n.start(i),c[t]=n,u[t]=!0,console.log(`[${t}] startet in ${o.toFixed(2)}s`)}function B(t){c[t]&&(c[t].stop(),c[t].disconnect(),c[t]=null),u[t]=!1,Object.values(u).some(Boolean)||(f=null,console.log("Alle Loops gestoppt – startTime zurückgesetzt."))}function L(t){t.classList.add("ld","ld-breath")}function h(t){t.classList.remove("ld","ld-breath")}function m(t){t.classList.add("active")}function $(t){t.classList.remove("active")}function l(t){const o=document.getElementById(`${t}-btn`);o.addEventListener("click",async()=>{if(console.log(`Button '${t}' clicked`),r.state==="suspended"&&await r.resume(),p[t]||await v(t,w[t]),u[t]){B(t),$(o);return}const n=Object.values(u).some(Boolean);let i=0;if(n){const e=g[t],s=(r.currentTime-f)%e;i=e-s,console.log(`[${t}] wartet ${i.toFixed(2)}s auf nächsten Takt`),L(o),setTimeout(()=>{h(o)},i*1e3)}else f=r.currentTime;b(t,i),m(o)})}l("eguitar");l("piano");l("pad");l("strings");l("melody");
